# 日報を完成させる

日報ファイルを整理し、完成させます。

## パス設定
- 日報保存先: `/Users/watarukasahara/Documents/kasaharu's vault/01_Daily/`
- テンプレート: `/Users/watarukasahara/Documents/kasaharu's vault/Templates/00_Daily Note.md`

## 実行手順

### 1. 対象ファイルの選択（二分探索）

#### 1.1 ファイル一覧の取得
1. 日報保存先ディレクトリ直下から `YYYY-MM-DD.md` 形式のファイルのみを抽出（サブディレクトリは対象外）
2. ファイル名を日付順（昇順）にソート

#### 1.2 二分探索で境界を特定
処理済み（`finalized: true`）と未処理の境界を二分探索で見つける:

```
left = 0, right = ファイル数 - 1
boundary = -1  // 最後の処理済みファイルのインデックス

while left <= right:
    mid = (left + right) / 2
    if ファイル[mid] に finalized: true がある:
        boundary = mid
        left = mid + 1  // 右半分を探索
    else:
        right = mid - 1  // 左半分を探索

未処理ファイル = ファイル[boundary + 1 ...]
```

#### 1.3 結果に基づく処理
1. 未処理ファイルが複数ある場合:
   - 一覧を表示し、`AskUserQuestion` ツールで選択を求める
2. 未処理ファイルが1つの場合:
   - そのまま処理を続行
3. 未処理ファイルがない場合:
   - 「処理対象のファイルがありません」と報告して終了

#### 1.4 フォールバック
二分探索の前提（古いファイルが処理済み、新しいファイルが未処理）が崩れている場合は、全件スキャンにフォールバックする。

### 2. テンプレートの読み込み

テンプレートファイルを読み込み、各セクションの初期状態を把握する。

### 3. セクションの差分検出と処理

以下のチェックボックスと詳細セクションの対応関係に基づいて処理を行う:

| チェックボックス | 詳細セクション |
|---|---|
| `- [ ] 💻 技術的な学び` | `### 💻 技術的な学び` |
| `- [ ] 🔧 問題解決` | `### 🔧 問題解決` |
| `- [ ] 👥 チーム・メンタリング` | `### 👥 チーム・メンタリング` |
| `- [ ] 🌱 技術以外の気づき・学び` | `### 🌱 技術以外の気づき・学び` |
| `- [ ] 📚 読書` | `### 📚 読書` |
| `- [ ] 🏃 運動` | `### 🏃 運動` |
| `- [ ] 💡 個人的な気づき` | `### 💡 個人的な気づき` |
| `- [ ] 📌 明日への準備` | `### 📌 明日への準備` |

各詳細セクションについて:

1. **テンプレートと比較して差分があるか判定**
   - 以下のみの場合は「差分なし」と判定:
     - HTMLコメント（`<!-- ... -->`）
     - 空行
     - リストのプレースホルダ（`- ` のみ、`- [ ] ` のみ）
     - テンプレートと完全に同一の内容
   - 上記以外の内容がある場合は「差分あり」と判定

2. **差分がある場合**:
   - 対応するチェックボックスを `- [x]` に変更
   - セクションはそのまま保持

3. **差分がない場合**:
   - セクション全体を削除（見出しから次のセクションの見出しまで）

### 4. 常に保持するセクション

以下のセクションは差分の有無に関わらず削除しない:
- `## 🎯 今日の振り返り（必須 - 1分）`
- `## ✅ 今日書くこと（該当するものだけチェック ✓）`
- `## TODO`
- `## 📝 詳細（チェックした項目だけ書く）`（見出しのみ）
- `## 💭 メモ・その他`
- frontmatter（`---` で囲まれた部分）
- 区切り線 `---`
- 所要時間の記載（`**所要時間**:`）
- `■ 以下、月次サマリー対象外` 以降

### 5. 処理済みマークの追加

frontmatter に `finalized: true` を追加する。

例:
```yaml
---
id: "202501011200"
createdAt: "#2025/01/01"
tags:
  - "#daily"
  - 2025/01
finalized: true
---
```

### 6. 完了報告

処理が完了したら、以下を報告:
- 処理したファイル名
- チェックを入れたセクション
- 削除したセクション
