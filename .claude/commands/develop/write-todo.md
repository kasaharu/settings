# Write TODO File

これまでの作業コンテキストを TODO ファイルに書き込むコマンドです。
この処理のやりとりは日本語でお願いします。

## 目的

- 作業の中断時に、現在の状態を保存する
- 次回のセッションで作業を再開しやすくする
- TODO の進捗状況を更新する

## タスク

### ステップ 1: 既存 TODO ファイルの確認

カレントディレクトリで以下のパターンに一致するファイルを検索:

- `TODO` で始まるファイル名（例: `TODO`, `TODO.md`, `TODO.txt`）
- もし `tmp/` というディレクトリがある場合はその中は無視してよい
- 大文字・小文字を区別しない

### ステップ 2: ファイルの決定

1. **ファイルが見つからない場合**:

   - `TODO.md` を新規作成する旨を通知

2. **ファイルが 1 つだけの場合**:

   - そのファイルを更新対象とする

3. **ファイルが複数ある場合**:
   - AskUserQuestion で更新対象を確認

### ステップ 3: コンテキストの整理

これまでの会話から以下の情報を抽出・整理:

1. **完了したタスク**: 今回のセッションで完了した作業
2. **未完了のタスク**: まだ終わっていない作業
3. **発見した課題**: 作業中に見つかった問題点
4. **次回への申し送り**: 次のセッションで最初に確認すべきこと

### ステップ 4: ファイルの更新

既存ファイルがある場合は、元の内容を考慮して差分を反映:

- 完了したタスクは「完了」セクションに移動またはチェック済みにする
- 新しいタスクや課題を追加
- 申し送り事項を更新

### ステップ 5: 書き込み内容の確認

書き込む前に、更新内容をユーザーに提示して確認を求める。

## 出力フォーマット

```markdown
# TODO

最終更新: {current_date}

## 未完了タスク

- [ ] タスク 1
- [ ] タスク 2

## 完了タスク

- [x] 完了したタスク 1
- [x] 完了したタスク 2

## 発見した課題

- 課題 1 の説明
- 課題 2 の説明

## 次回への申し送り

- 次回最初に確認すべきこと
- 作業再開時の注意点
```

## 実行例

```
/write-todo
```

これにより:

1. 既存の TODO ファイルを確認
2. これまでの作業内容を整理
3. 更新内容を確認後、ファイルに書き込み
